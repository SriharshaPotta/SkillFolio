import { View, Text, Button, StyleSheet, SafeAreaView, TextInput } from 'react-native';
import React, { useState } from 'react';
import { useAuth, useUser } from '@clerk/clerk-expo';
import { defaultStyles } from "constants/styles";
import Colors from "constants/Colors";


const UpdateUserInfo = () => {
  const { isSignedIn } = useAuth();
  const { user } = useUser();
  const [firstName, setFirstName] = useState(user?.firstName || '');
  const [lastName, setLastName] = useState(user?.lastName || '');
  const [email, setEmail] = useState(user?.emailAddresses[0]?.emailAddress || '');

  const handleUpdateUserInfo = async () => {
    try {
      if (!firstName || !lastName || !email) {
        console.error('Please fill in all fields.');
        return;
      }

      await user?.updateUserInfo({
        firstName,
        lastName,
        emailAddresses: [{ emailAddress: email }],
      });

      console.log('User information updated successfully!');
    } catch (err) {
      console.error('Error updating user information:', err);
    }
  };

  return (
    <SafeAreaView style={defaultStyles.container}>
      <View style={styles.container}>
        <Text style={styles.heading}>Update User Information</Text>

        <TextInput
          style={defaultStyles.inputField}
          placeholder="First Name"
          value={firstName}
          onChangeText={setFirstName}
        />

        <TextInput
          style={defaultStyles.inputField}
          placeholder="Last Name"
          value={lastName}
          onChangeText={setLastName}
        />

        <TextInput
          style={defaultStyles.inputField}
          placeholder="Email Address"
          value={email}
          onChangeText={setEmail}
        />

        <Button
          title="Update Information"
          onPress={handleUpdateUserInfo}
          color={Colors.primary}
          disabled={!isSignedIn}
        />
      </View>
    </SafeAreaView>
  );
};

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: 'center',
    alignItems: 'center',
    padding: 24,
  },
  heading: {
    fontSize: 24,
    fontWeight: 'bold',
    marginBottom: 24,
  },
});

export default UpdateUserInfo;